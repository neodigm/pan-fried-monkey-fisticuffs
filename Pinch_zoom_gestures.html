<!DOCTYPE html>
<html lang=en>
<head>
  <title>Neodigm | Pointer Events Pinch/Zoom pattern</title>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=2, minimum-scale=1, width=device-width, height=device-height"/>
</head>

<body>

  <section style="touch-action:none"
  data-panzoom="true">
    <img src="https://www.ltdcommodities.com/images/product/90323_1324569_WOY_zm1.jpg">
  </section>
 <hr>
  <section style="touch-action:none"
  data-panzoom="true">
    <img src="https://www.ltdcommodities.com/images/product/90323_1324569_WOY_zm.jpg">
  </section>
<hr>
<pre>log</pre>

<script>
var eLog = document.querySelector("pre");

function debounce(func, wait, immediate) {
	var timeout;
	return function() {
		var context = this, args = arguments;
		var later = function() {
			timeout = null;
			if (!immediate) func.apply(context, args);
		};
		var callNow = immediate && !timeout;
		clearTimeout(timeout);
		timeout = setTimeout(later, wait);
		if (callNow) func.apply(context, args);
	};
};

let fPanZ = ((_d)=>{
  let aElem = []; // Elements
  let nXYdiff = -1;
  let fZi, fZo;
  return {
    "init": (sQuery, _fZi, _fZo)=>{ // DOM Query, Zoom In, Zoom Out call backs
      let aTarg = _d.querySelectorAll( sQuery );
      if( _fZi ) fZi = _fZi;
      if( _fZo ) fZo = _fZo;
      aTarg.forEach( ( eTarg )=>{
        let eImg = eTarg.querySelector( "img" );
        eTarg.aEv = [];
        aElem.push( eTarg );
        eTarg.onpointerdown = fPanZ.pointDown;
        eTarg.onpointermove = fPanZ.pointMove;
          eTarg.onpointerup     = fPanZ.pointUp;
          eTarg.onpointercancel = fPanZ.pointUp;
          eTarg.onpointerout    = fPanZ.pointUp;
          eTarg.onpointerleave  = fPanZ.pointUp;
      });
      return ( aTarg.length !== 0 );
    },
    "pointDown": function(ev){ this.aEv.push( ev ); },
    "pointMove": function(ev){
      this.aEv = this.aEv.map(function( _ev ){ // Update Event
        return ( _ev.pointerId === ev.pointerId ) ? ev : _ev;
      });

      if( this.aEv.length == 2) { // Distance between two pointers
        var nXYnew = Math.abs(this.aEv[0].clientX - this.aEv[1].clientX);
        if( nXYdiff > 0) {
          if( nXYnew > nXYdiff) { debounce(function() { fPanZ.doZoomIn(); }, 100); }
          if( nXYnew < nXYdiff) { debounce(function() { fPanZ.doZoomOut(); }, 100); }
        }
        nXYdiff = nXYnew;
      }
     },
    "pointUp":   function(ev){
      this.aEv = this.aEv.filter(function( _ev ){
        return ( _ev.pointerId !== ev.pointerId ); });
      if( this.aEv.length < 2 ) nXYdiff = -1; // reset
     },
     "doZoomIn": function(){
console.log("in");
//eLog.innerHTML = eLog.innerHTML + " in\n"; 
        if( fZi ) debounce(function() { fZi(); }, 100);
     },
     "doZoomOut": function(){
console.log("out");       
        if( fZo ) debounce(function() { fZo(); }, 100);
     }
  };
})( document );

fPanZ.init("[data-panzoom]", ()=>{ eLog.innerHTML = eLog.innerHTML + " in\n"; }, ()=>{ eLog.innerHTML = eLog.innerHTML + " out\n"; });

</script>

<style>
  [data-panzoom] {width: 44%;margin: 8px auto; border: solid 1px #444;}
  [data-panzoom] img {width: 100%}
</style>
</body>
</html>